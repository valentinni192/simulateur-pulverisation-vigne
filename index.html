<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulateur Pulvérisation Vigne</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #e0eafc, #cfdef3);
      margin: 0;
      padding: 2rem;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 2rem;
    }
    label {
      display: block;
      margin-top: 1.2rem;
      font-weight: 500;
    }
    input, select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 0.3rem;
      font-size: 1rem;
    }
    button {
      margin-top: 2rem;
      padding: 1rem 2rem;
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #357ab8;
    }
    .result {
      margin-top: 2rem;
      background: #f5faff;
      padding: 1.5rem;
      border-left: 4px solid #4a90e2;
      border-radius: 8px;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Simulateur de pulvérisation en vigne</h1>

    <label>Volume de bouillie (L/ha): <input type="number" id="volume" /></label>
    <label>Vitesse d'avancement (km/h): <input type="number" id="vitesse" /></label>
    <label>Pression (bar): <input type="number" id="pression" /></label>
    <label>Largeur de rang (m): <input type="number" id="largRang" /></label>
    <label>Espacement entre ceps (m): <input type="number" id="espCeps" /></label>
    <label>Hauteur de canopée (m): <input type="number" id="hautCan" /></label>
    <label>Largeur de canopée (m): <input type="number" id="largCan" /></label>
    <label>Porosité de la végétation (%): <input type="number" id="porosite" /></label>

    <label>Type de pulvérisation :
      <select id="typePulv">
        <option value="insecticide">Insecticide</option>
        <option value="herbicide_pre">Herbicide pré-émergence</option>
        <option value="herbicide_post">Herbicide post-émergence</option>
        <option value="fongicide">Fongicide</option>
      </select>
    </label>

    <button onclick="calculer()">Calculer</button>

    <div class="result" id="resultat"></div>
  </div>

  <script>
    function calculer() {
      const vol = parseFloat(document.getElementById("volume").value);
      const vit = parseFloat(document.getElementById("vitesse").value);
      const pres = parseFloat(document.getElementById("pression").value);
      const lr = parseFloat(document.getElementById("largRang").value);
      const ec = parseFloat(document.getElementById("espCeps").value);
      const hc = parseFloat(document.getElementById("hautCan").value);
      const lc = parseFloat(document.getElementById("largCan").value);
      const p = parseFloat(document.getElementById("porosite").value);
      const typePulv = document.getElementById("typePulv").value;

      if (isNaN(vol) || isNaN(vit) || isNaN(pres) || isNaN(lr) || isNaN(ec) || isNaN(hc) || isNaN(lc) || isNaN(p)) {
        document.getElementById("resultat").innerText = "Veuillez remplir tous les champs.";
        return;
      }

      const seuils = {
        insecticide: [20, 30],
        herbicide_pre: [20, 30],
        herbicide_post: [30, 40],
        fongicide: [50, 70]
      };

      const piedsHa = 10000 / (lr * ec);
      const surfFoliaire = hc * lc * piedsHa * (1 - p / 100);
      const nbGouttesTot = vol * 1000000 / 0.0001;
      const efficDep = 0.25;
      const nbGouttesDep = nbGouttesTot * efficDep;
      const densite = nbGouttesDep / surfFoliaire / 10000; // en gouttes/cm²

      const [min, max] = seuils[typePulv];
      let qualite = "Insuffisante";
      if (densite >= max) qualite = "Optimale";
      else if (densite >= min) qualite = "Suffisante";

      document.getElementById("resultat").innerHTML = `
        <strong>Résultats :</strong><br/><br/>
        <strong>Surface foliaire estimée :</strong> ${surfFoliaire.toFixed(0)} m²/ha<br/>
        <strong>Nombre de gouttelettes déposées :</strong> ${nbGouttesDep.toExponential(2)}<br/>
        <strong>Densité de dépôt :</strong> ${densite.toFixed(1)} gouttes/cm²<br/>
        <strong>Qualité de couverture :</strong> <em>${qualite}</em> (réf. ${min}-${max} gouttes/cm² pour ${typePulv.replace('_', ' ')})<br/><br/>
        <strong>Nombre de pieds par hectare :</strong> ${piedsHa.toFixed(0)}<br/>
        <strong>Surface foliaire par pied :</strong> ${(hc * lc).toFixed(2)} m²<br/>
        <strong>Volume foliaire traité (m³/ha) :</strong> ${(hc * lc * lr * piedsHa).toFixed(2)}
      `;
    }
  </script>
</body>
</html>
